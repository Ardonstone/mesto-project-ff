/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}};t.d({},{F:()=>Y});var e={};function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i=document.querySelector("#card-template").content.querySelector(".places__item").cloneNode(!0),u=i.querySelector(".card__image"),c=i.querySelector(".card__like-block_button"),a=i.querySelector(".card__like-block_counter"),l=i.querySelector(".card__delete-button"),s=t.name,p=t.link;return u.src=p,u.alt=s,i.querySelector(".card__title").textContent=s,t.likes.find((function(e){t.owner._id}))&&c.classList.toggle("card__like-block_button_is-active"),e===t.owner._id&&o(l,t._id),a.textContent=t.likes.length,u.addEventListener("click",(function(){n(s,p)})),c.addEventListener("click",(function(){r(c,a,t._id)})),i}function r(t,n,r){(t.classList.contains("card__like-block_button_is-active")?e.requestAPI.deleteLike(r):e.requestAPI.likeCard(r)).then((function(e){!function(t,e,n){e.textContent=n.length,t.classList.contains("card__like-block_button_is-active")?t.classList.remove("card__like-block_button_is-active"):t.classList.add("card__like-block_button_is-active")}(t,n,e.likes)})).catch((function(t){return console.log(t)}))}function o(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",u(evt))}function i(t){t.classList.remove("popup_is-opened"),document.removeEventListener("keydown",u(evt))}function u(t){"Escape"===t.key&&document.querySelector(".popup_is-opened")&&i(document.querySelector(".popup_is-opened"))}function c(t){var e=t.formElement,n=t.inputElement,r=t.inputErrorClass,o=t.errorClass,i=e.querySelector(".".concat(n.id,"-error"));n.classList.remove(r),i.classList.remove(o),i.textContent=""}function a(t){var e=t.inputList,n=t.submitButtonElement,r=t.inactiveButtonClass;!function(t){return t.some((function(t){return!t.validity.valid}))}(e)?(n.disable=!1,n.classList.remove(r)):(n.disable=!0,n.classList.add(r))}function l(t,e){var n=e.inputSelector,r=e.submitButtonSelector,o=e.inactiveButtonClass,i=e.inputErrorClass,u=e.errorClass,l=Array.from(t.querySelectorAll(n)),s=t.querySelector(r);l.forEach((function(e){c({formElement:t,inputElement:e,inputErrorClass:i,errorClass:u})})),a({inputList:l,submitButtonElement:s,inactiveButtonClass:o})}function s(t,e){t.textContent=e?"Сохранение...":"Сохранить"}function p(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var a=r&&r.prototype instanceof c?r:c,l=Object.create(a.prototype);return f(l,"_invoke",function(n,r,o){var i,c,a,l=0,s=o||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,a=t,f.n=n,u}};function d(n,r){for(c=n,a=r,e=0;!p&&l&&!o&&e<s.length;e++){var o,i=s[e],d=f.p,m=i[2];n>3?(o=m===r)&&(a=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,f.v=r,f.n=i[1]):d<m&&(o=n<3||i[0]>r||r>m)&&(i[4]=n,i[5]=r,f.n=m,c=0))}if(o||n>1)return u;throw p=!0,r}return function(o,s,m){if(l>1)throw TypeError("Generator is already running");for(p&&1===s&&d(s,m),c=s,a=m;(e=c<2?t:a)||!p;){i||(c?c<3?(c>1&&(f.n=-1),d(c,a)):f.n=a:f.v=a);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(p=f.n<0)?a:n.call(r,f))!==u)break}catch(e){i=t,c=1,a=e}finally{l=1}}return{value:e,done:p}}}(n,o,i),!0),l}var u={};function c(){}function a(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(f(e={},r,(function(){return this})),e),d=l.prototype=c.prototype=Object.create(s);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,f(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return a.prototype=l,f(d,"constructor",l),f(l,"constructor",a),a.displayName="GeneratorFunction",f(l,o,"GeneratorFunction"),f(d),f(d,o,"Generator"),f(d,r,(function(){return this})),f(d,"toString",(function(){return"[object Generator]"})),(p=function(){return{w:i,m}})()}function f(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}f=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){f(t,e,(function(t){return this._invoke(e,n,t)}))}i("next",0),i("throw",1),i("return",2)}},f(t,e,n,r)}function d(t,e,n,r,o,i,u){try{var c=t[i](u),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}t.r(e);var v,y,_,b,S,E,h,C,g,q={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},k=document.querySelector(".places__list"),L=document.querySelector(".popup_type_edit"),w=document.querySelector(".popup_type_edit-avatar"),A=document.querySelector(".popup_type_new-card"),P=document.querySelector(".popup_type_image"),B=document.querySelector(".popup_type_confirm"),O=document.querySelectorAll(".popup"),j=document.querySelector(".popup__image"),x=document.querySelector(".popup__caption"),I=document.querySelector(".profile__edit-button"),T=document.querySelector(".profile__add-button"),M=document.querySelector(".profile__info"),G=M.querySelector(".profile__title"),D=M.querySelector(".profile__description"),F=document.querySelector(".profile__image"),N=document.forms["edit-profile"],V=N.name,U=N.description,$=N.querySelector(".button"),z=document.forms["edit-avatar"],H=z.querySelector(".popup__button"),J=z.avatar,K=document.forms["new-place"],Q=K["place-name"],R=K.link,W=K.querySelector(".popup__button"),X=document.forms["delete-card"];function Y(t){!0===t?o(B):i(B)}function Z(t,e,n){G.textContent=t,D.textContent=e,F.style.backgroundImage="url(".concat(n,")")}function tt(t,e){j.src=e,j.alt=t,x.textContent=t,o(P)}function et(t,e){t.style.display="block",t.addEventListener("click",(function(){Y(!0),y=e,v=t}))}F.addEventListener("click",(function(){o(w)})),T.addEventListener("click",(function(){o(A)})),I.addEventListener("click",(function(){U.value=D.textContent,V.value=G.textContent,o(L)})),z.addEventListener("submit",(function(t){!function(t){t.preventDefault(),s(H,!0),e.requestAPI.setAvatar({avatar:J.value}).then((function(t){Z(t.name,t.about,t.avatar),i(w),z.reset(),l(z,q)})).catch((function(t){console.log(t)})).finally((function(){s(H,!1)}))}(t)})),N.addEventListener("submit",(function(t){!function(t){t.preventDefault(),s($,!0),e.requestAPI.setProfile({name:V.value,about:U.value}).then((function(t){Z(t.name,t.about,t.avatar),i(L),N.reset(),l(N,q)})).catch((function(t){console.log(t)})).finally((function(){s($,!1)}))}(t)})),K.addEventListener("submit",(function(t){!function(t){t.preventDefault(),s(W,!0),e.requestAPI.addCard({name:Q.value,link:R.value}).then((function(t){k.prepend(n(t,t.owner._id,tt,r,et)),i(A),K.reset(),l(K,q)})).catch((function(t){console.log(t)})).finally((function(){s(W,!1)}))}(t)})),X.addEventListener("submit",(function(t){!function(t,n,r){t.preventDefault(),e.requestAPI.deleteCard(r).then((function(){n.closest(".places__item").remove(),Y(!1)})).catch((function(t){return console.log(t)}))}(t,v,y)})),O.forEach((function(t){t.classList.add("popup_is-animated"),t.querySelector(".popup__close").addEventListener("click",(function(){i(t)})),t.addEventListener("mousedown",(function(e){!function(t,e){t.target===t.currentTarget&&i(e)}(e,t)}))})),b=(_=q).formSelector,S=_.inputSelector,E=_.submitButtonSelector,h=_.inactiveButtonClass,C=_.inputErrorClass,g=_.errorClass,Array.from(document.querySelectorAll(b)).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),function(t){var e=t.formElement,n=t.inputSelector,r=t.submitButtonSelector,o=t.inactiveButtonClass,i=t.inputErrorClass,u=t.errorClass,l=Array.from(e.querySelectorAll(n)),s=e.querySelector(r);a({inputList:l,submitButtonElement:s,inactiveButtonClass:o}),l.forEach((function(t){t.addEventListener("input",(function(){!function(t){var e=t.formElement,n=t.inputElement,r=t.inputErrorClass,o=t.errorClass;n.validity.patternMismatch?n.setCustomValidity(n.dataset.errorMessage):n.setCustomValidity(""),n.validity.valid?c({formElement:e,inputElement:n,inputErrorClass:r,errorClass:o}):function(t){var e=t.inputElement,n=t.inputErrorClass,r=t.errorClass,o=t.errorMessage,i=t.formElement.querySelector(".".concat(e.id,"-error"));i.textContent=o,e.classList.add(n),i.classList.add(r)}({formElement:e,inputElement:n,inputErrorClass:r,errorClass:o,errorMessage:n.validationMessage})}({formElement:e,inputElement:t,inputErrorClass:i,errorClass:u}),a({inputList:l,submitButtonElement:s,inactiveButtonClass:o})}))}))}({formElement:t,inputSelector:S,submitButtonSelector:E,inactiveButtonClass:h,inputErrorClass:C,errorClass:g})})),Promise.all([e.requestAPI.getProfile(),e.requestAPI.getCards()]).then((function(t){var e,o,i=(o=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,u,c=[],a=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{if(!a&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw o}}return c}}(e,o)||function(t,e){if(t){if("string"==typeof t)return m(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(e,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=i[0],c=i[1];Z(u.name,u.about,u.avatar),c.forEach(function(){var t,e=(t=p().m((function t(e){return p().w((function(t){for(;;)switch(t.n){case 0:k.append(n(e,u._id,tt,r,et));case 1:return t.a(2)}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){d(i,r,o,u,c,"next",t)}function c(t){d(i,r,o,u,c,"throw",t)}u(void 0)}))});return function(t){return e.apply(this,arguments)}}())})).catch((function(t){console.log(t)}))})();